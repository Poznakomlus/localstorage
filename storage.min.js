(function(e){var d=function(a,b){var c;if("undefined"==typeof Storage)throw Error("_storage: Web Storage no support");d.prototype.instance?c=d.prototype.instance:(c=Object.create(d.prototype),d.prototype.instance=c,c._init());if(1==arguments.length)return c.get(a);2==arguments.length&&c.set(a,b);return c};d.prototype={_list:{},_init:function(){e.addEventListener("storage",this._storageEvent.bind(this))},subscribe:function(a,b){void 0!=a&&"function"==typeof b&&(this._list.hasOwnProperty(a)||(this._list[a]=
[]),this._list[a].push(b));return this},unSubscribe:function(a,b){this._list.hasOwnProperty(a)&&this._list[a].length&&("function"==typeof b?this._list[a].some(function(a,d,e){if(a==b)return e.splice(d,1),!0}):delete this._list[a]);return this},_storageEvent:function(a){if(this._list.hasOwnProperty(a.key)){var b=this;this._list[a.key].forEach(function(c){c(b.get(a.key),a)})}},get:function(a){(a=localStorage.getItem(a))&&/^~(f|o)~/.test(a)&&(a="f"==a.slice(1,2)?Function("return "+a.slice(3))():JSON.parse(a.slice(3)));
return a},set:function(a,b){var c=typeof b;"function"==c?b="~f~"+b.toString():"Object"==c&&(b="~o~"+JSON.Stringify(b));localStorage.setItem(a,b);return this},remove:function(a){localStorage.removeItem(a);return this},clear:function(){localStorage.clear();return this}};e._storage=d})(window);
